rules:
  - name: Reverse Shell Pattern
    description: Bash spawned by network service may indicate reverse shell
    severity: warning
    match:
      process_name: bash
      process_name_type: exact
      parent_name: nc
      parent_name_type: contains
    action: alert
    type: exec
  - name: Shell from Web Server
    description: Shell execution from web server process
    severity: warning
    match:
      process_name: bash
      process_name_type: exact
      parent_name: apache
      parent_name_type: contains
    action: alert
    type: exec
  - name: Shell from Nginx
    description: Shell execution from nginx process
    severity: warning
    match:
      process_name: bash
      process_name_type: exact
      parent_name: nginx
      parent_name_type: contains
    action: alert
    type: exec
  - name: Access to sensitive files
    description: Access to sensitive system files that should be monitored
    severity: high
    match:
      filename: /etc/shadow
    action: alert
    type: file
  - name: Suspicious Outbound Connection
    description: Network connection to potentially suspicious port (e.g., reverse shell ports)
    severity: high
    match:
      dest_port: 4444
    action: alert
    type: connect
  - name: Connection to Common C2 Port
    description: Connection to port 8080, commonly used for command and control
    severity: warning
    match:
      dest_port: 8080
    action: alert
    type: connect
